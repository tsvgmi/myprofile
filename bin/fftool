#!/bin/bash
. ${0%/*}/../etc/tool.env
#######################################################################
# File: 	admtool
# Description:  Sysadmin tools
# Created:	2002-06-23
# $Id$
#######################################################################

PATH=$PATH:/sw/sbin:/opt/local/bin

#------------------------------------------------------ Begin of script ---
#------------------------------------------------------ Begin of script ---
#------------------------------------------------------ Begin of script ---

F_subCommand $*
oper=$1; shift
case $oper in

  #@Use: harvest-cache [-k] [-s] [-w time] [-t sound|image] [filetype ....]
  harvest-cache)
    ftypes= ropt=
    while getopts :ckst:w: i; do
      case $i in
      [ks]) ropt="$ropt -$i" ;;
      w)    ropt="$ropt -$i $OPTARG" ;;
      t)
        case $OPTARG in
        sound) ftypes="mp3 mid" ;;
        image) ftypes="jpg gif png" ;;
        video) ftypes="mp4" ;;
        zip)   ftypes="gz" ;;
        *)     F_abort "Support sound/image only" ;;
        esac
        ;;
      *) F_usageOper $oper ;;
      esac
    done
    let j=$OPTIND-1; shift $j; OPTIND=0
    [ "$ftypes" ] && set -- $ftypes
    [ $# -gt 0 ] || F_usageOper $oper
    case $EM_OSTYPE in
    osx)
      bdir=$HOME/Library/Caches/Firefox/Profiles
      ;;
    *)
      F_abort "Unsupported OS: $EM_OSTYPE"
      ;;
    esac
    F_logProgress "Harvesting from $bdir"
    F_rbexec ffhelper $ropt harvest $bdir $*
    ;;

  *)
    F_usageOper $oper
    ;;
esac
exit 0

